# 第一章、计算机系统概论
+ ![](Attachments/Pasted%20image%2020240416161503.png)
+ ![](Attachments/Pasted%20image%2020240619132106.png)
+ **CPI（Clock Cycles Per Instruction）**
  每条指令所需的**时钟周期数**（一个周期等于频率的倒数）
  主频：每秒发生多少个周期变化
  例：1.2 GHz 表示每秒 $1.2\times 10^9$ 个时钟周期
  那么，$\frac{f}{CPI}$ 就是指每秒执行多少条指令

+ 运算器、存储器、控制器、输入设备、输出设备——**计算机硬件系统**
# 第二章、运算方法和运算器
+ **原码**
  ＞0 就为 x，＜0 就把符号位置为 1
  **$+0$ 和 $-0$ 不一样**：00000000、10000000

+ **补码**
  ＞0 就为 x，＜0 即**符号位置 1，其余位求反，最后末尾+1**
  **$+0$ 和 $-0$ 一样**：00000000

+ **反码**
  ＞0 就为 x，＜0 各位取反 ![150](Attachments/Pasted%20image%2020240619135257.png)
+ **移码**
  在真值 X 上加一个常数偏移值 bias，通常为 $2^n$

+ **关系比较**
  负数的补码 = 反码+1
  移码和补码位数相同，符号相反

+ **移位**
  算术移位的法则（**有符号数的移位法则**） 
  - 符号位保持不动
  - 正数：原码、补码、反码均补 0  
  - 负数  
    + 原码：补 0 
    + 补码：左移补 0；右移补 1 
    + 反码：补 1

+ **浮点数**
  IEEE 754 浮点数标准：
  真值计算：$(-1)^S\times (1 + Frac) \times 2^{(E - Bias)}$
  ![500](Attachments/Pasted%20image%2020240619144303.png)

## 定点加法、减法
+ **补码加法、减法**![450](Attachments/Pasted%20image%2020240619145426.png)
+ **双符号位表示溢出**
  两数相加后，结果的符号位出现**01**或**10**两种情况时，表示发生溢出 
  最高符号位永远表示结果的正确符号

+ **单符号位表示溢出**![400](Attachments/Pasted%20image%2020240619141854.png)
  参考 PPT 例题 P35

+ **加法器/减法器**
  见 PPT
  $C_i=A_iB_i+(A_i\oplus B_i)C_{i-1}$

## 定点乘法运算
+ **间接补码乘法**
  正数：尾数参加无符号数乘法器运算 
  负数：由补码求得其绝对值后参加无符号数乘法器运算 
  符号位通过异或门得到乘积的符号 
  若乘积为负数，需将乘积的绝对值经过求补电路得到积的补码


# 第三章、存储系统
+ **多级存储体系的组成**![450](Attachments/Pasted%20image%2020240619193856.png)

+ **位扩展、字扩展、字位扩展**
  要求会画电路图
+ **DRAM 地址线分时复用**
  $1M\times4$ 芯片：20 条地址线，4 条数据引脚
  $1M\times4$ DRAM 芯片：10 条地址线（先送行地址，再送列地址）（加入了两个控制信号）
+ **DRAM 刷新**
  + 集中式刷新：在整个刷新间隔内，前一段时间进行读/写周期，等到需要进行刷新操作时，便暂停读/写周期，而逐行刷新整个存储器。![](Attachments/Pasted%20image%2020240422132513.png)
  + 分散式刷新：
    例如：某 DRAM 有 1024 行，若刷新周期为 8 ms，则必须在 8 ms 内把所有 1024 行刷新一遍。$8000μs÷1024≈7.8μs$，即每隔 7.8μs 刷新一行![](Attachments/Pasted%20image%2020240422132526.png)
+ DRAM 芯片的逻辑结构 ![450](Attachments/Pasted%20image%2020240422132814.png)
+ **增强性 DRAM:  EDRAM**![](Attachments/Pasted%20image%2020240619200715.png)
  - 在 DRAM 中增加了一个 SRAM 组成的 Cache，可以暂时保存最近访问的一行。
  - 增加比较器，如果下次访问的还是该行，则直接从 Cache 中读出 
  - 刷新该行和读 Cache 可并行操作，故刷新操作与访问操作不冲突。

+ **闪存**![350](Attachments/Pasted%20image%2020240422141915.png)
+ **多模块存储器**![](Attachments/Pasted%20image%2020240619203502.png)
## Cache 
+ ![](Attachments/Pasted%20image%2020240619204014.png)
+ **主存与 Cache 的地址映射**
  + **全相联映射**![](Attachments/Pasted%20image%2020240619204936.png)
  + **直接映射**![](Attachments/Pasted%20image%2020240619205548.png)
  + **v 路组相联映射**
    组相联映射方式是前两者的折衷方案，被普遍采用 
    将 Cache 分成 u 组，每组 v 行，主存块存放到哪个组是固定的，放在组内的哪一行是任意的。 
    组号：$q = j \mod u$；对应多个块![](Attachments/Pasted%20image%2020240619205810.png)

+ **Cache 块替换策略**![450](Attachments/Pasted%20image%2020240619210052.png)
+ **Cache 性能指标**![](Attachments/Pasted%20image%2020240619211141.png)
  
## 虚拟存储器
+ ![](Attachments/Pasted%20image%2020240619220429.png)
+ ![](Attachments/Pasted%20image%2020240619214429.png)


# 第四章、指令系统
+ **指令格式**
  - 构成：操作码字段 OP+地址码字段 A
  - 操作码字段的位数一般取决于计算机指令系统的规模
    如果某指令系统只有 8 条指令，则用 3 位操作码就可表示
    如果有 32 条指令，那么就需要 5 位操作码
  - 指令字中操作码字段长度可以是固定的，也可以是变长的
![550](Attachments/Pasted%20image%2020240422143211.png)
+ **地址码**![](Attachments/Pasted%20image%2020240619221602.png)
## 指令和数据的寻址方式
+ **指令顺序寻址方式**
  PC 执行一条指令需要自增，+的值取决于指令字长
+ **指令跳跃寻址方式**![](Attachments/Pasted%20image%2020240619222333.png)

+ **数据寻址方式**
> ![350](Attachments/Pasted%20image%2020240619222702.png)
> 1. **隐含寻址**![400](Attachments/Pasted%20image%2020240619222639.png)
> 2. **立即寻址**：指令的地址字段指出的不是操作数的地址，而是**操作数本身**。![400](Attachments/Pasted%20image%2020240619222735.png)
> 3. **直接寻址**：![400](Attachments/Pasted%20image%2020240619222826.png)
> 4. **间接寻址**：两次访存!!![](Attachments/Pasted%20image%2020240619222850.png)
> 5. **寄存器寻址**：给出的是通用寄存器的**编号**![400](Attachments/Pasted%20image%2020240619223059.png)
> 6. **寄存器间接寻址**：先找寄存器的值，这个值是数据的地址，再去找地址 ![400](Attachments/Pasted%20image%2020240619223154.png)
> 7. **偏移寻址**：![300](Attachments/Pasted%20image%2020240619223257.png)
>    7.1. **相对寻址**：程序计数器 PC +偏移量 A （**有符号数**）而形成操作数的有效地址 ![400](Attachments/Pasted%20image%2020240619223353.png)
>    7.2. **基址寻址**： CPU 中基址寄存器+偏移量 A 得到操作数有效地址 ![400](Attachments/Pasted%20image%2020240619223437.png)
>    7.3. **变址寻址**：CPU 中**变址寄存器**+偏移量 A 得到操作数有效地址。与基址寻址方式类似。但变址寄存器的内容**自动**递增或递减。![400](Attachments/Pasted%20image%2020240619223602.png)
> 8. **段寻址**：![350](Attachments/Pasted%20image%2020240619224255.png)
> 9. **堆栈寻址**：![350](Attachments/Pasted%20image%2020240619224354.png)
> ![](Attachments/Pasted%20image%2020240619224716.png)


# 第五章、中央处理器
+ **CPU 的基本组成** —— 控制器、运算器
+ **CPU 中的主要寄存器**
 > 1. 数据缓冲寄存器（DR） 
  >2. **指令寄存器（IR）** 
  >   保存当前正在执行的一条指令
  >3. **程序计数器（PC）** 
  >   也称为指令计数器，用来确定下一条指令的地址
  >   PC 的值始终是将要执行的下一条指令地址  
  >4. **地址寄存器（AR）** 
  >   保存当前处理器所访问的数据 cache 中单元的地址
  >5. 通用寄存器（$R_0$ ~ $R_3$）  
  >6. **状态条件寄存器（PSW）**
  >   保存根据算术指令、逻辑指令等运行的结果而设定的各种条件码内容
  >   保存中断和系统工作状态等信息

+ **操作控制器**
  根据设计方法不同，操作控制器可分为： 
  1. **时序逻辑型**：采用时序逻辑技术来实现。称为**硬布线控制器** 
  2. **存储逻辑型**：采用存储逻辑来实现。称为微程序控制器

+ **指令周期**
  **取指令**、**分析指令**并**执行指令**所需的总时间
  指令周期通常包含若干个 CPU 周期
  CPU 周期，也称机器周期
  CPU 周期通常包含若干个时钟周期（T 周期）![](Attachments/Pasted%20image%2020240620125758.png)![400](Attachments/Pasted%20image%2020240620130057.png)![](Attachments/Pasted%20image%2020240620130117.png)
+ **方框图语言**
  **方框**：代表一个 CPU 周期，方框中的内容表示数据通路的操作或某种控制操作 
  **菱形**：通常用来表示某种判别或测试，在<u>时间上依附于紧接它的前面一个方框的 CPU 周期</u>，不单独占用一个 CPU 周期

+ ![400](Attachments/Pasted%20image%2020240514163555.png)
+ **控制器的控制方式**
  同步控制：各指令在执行时所需的机器周期数 和时钟周期数都固定不变
  异步控制：每条指令、每个操作控制信号按需占用时间
  联合控制

+ **微操作分类** 
  1. **相容性操作**：同时或在同一个 CPU 周期内可以并行执行的微操作 
  2. **相斥性操作**：不能同时或不能在同一个 CPU 周期内并行执行的微操作

+ **微指令**：在机器的一个 CPU 周期中，一组实现一定操作功能的**微命令的组合**，构成一条微指令

+ **微指令基本格式**![400](Attachments/Pasted%20image%2020240620132845.png)
+ **控制存储器**：用来存放实现全部指令系统的微程序的只读存储器 ROM ![400](Attachments/Pasted%20image%2020240620151822.png)
+ **微程序**：一条机器指令是用许**多条微指令**组成的序列来实现的，这个微指令序列通常称为微程序。一条机器指令对应着一段微程序，而微程序的总和便可实现整个的指令系统

# 微指令编码
+ **直接表示法**![400](Attachments/Pasted%20image%2020240620134333.png)
+ **编码表示法**![](Attachments/Pasted%20image%2020240620134406.png)
+ **混合表示法**![400](Attachments/Pasted%20image%2020240620134510.png)

+ **微地址的形成方法**![](Attachments/Pasted%20image%2020240620134956.png)
+ **微指令格式**![](Attachments/Pasted%20image%2020240620135723.png)
+ **指令处理的分解**
  IF（Instruction Fetch 取指） ：从存储器取指令
  ID（Instruction Decode 指令译码） ：指令译码，读寄存器
  EX（Execution 执行） ：执行指令/计算地址
  WB（Write Back 写回）：结果写回寄存器
+ **流水线 CPU**![](Attachments/Pasted%20image%2020240620143417.png)
  
+ **流水线的性能指标**![450](Attachments/Pasted%20image%2020240620143653.png) ![](Attachments/Pasted%20image%2020240620143645.png)
+ **流水线冒险（相关）**
  + **资源相关（结构冒险）**：资源相关是指多条指令进入流水线后在同一机器时钟周期内争用同一个资源所发生的冲突
  + **数据相关（数据冒险）**：下一条指令会用到当前指令计算出的结果
    + 写后读 RAW（Read After Write）：后面指令用到前面指令所写的数据 
    + 写后写 WAW（Write After Write）：后面指令覆盖前面指令所写的单元 
    + 读后写 WAR（Write After Read）：后面指令覆盖前面指令所读的单元
  + **控制相关（控制冒险）**

+ ![](Attachments/Pasted%20image%2020240620144413.png)
+ **控制相关解决方法**![](Attachments/Pasted%20image%2020240620144651.png)

# 第六章、总线系统
+ 出于速度和效率上的考虑，系统总线上传送的信息必须采用**并行传送**方式![](Attachments/Pasted%20image%2020240620153745.png)
+ **总线的仲裁——集中仲裁：链式查询方式**![](Attachments/Pasted%20image%2020240620154249.png)
+ **计数器定时查询方式、独立请求方式**![](Attachments/Pasted%20image%2020240620154550.png)
+ **分布式仲裁**![](Attachments/Pasted%20image%2020240620154652.png)
+ **总线数据传送的两种方式** 
  **同步方式**：由统一时钟控制数据传送 
  **异步方式**：采用应答方式，没有公共时钟
  **半同步方式**：![](Attachments/Pasted%20image%2020240620155551.png)
+ **PCI**
  PCI 是一个与处理器无关的**高速外围总线**，它采用**同步**时序协议和**集中式**仲裁策略，并具有**自动配置**能力。![](Attachments/Pasted%20image%2020240620160157.png)
# 第七章、外围设备
+ **磁盘存储设备**
  **优点**：
  存储量大，位价格低 
  记录介质可以重复使用 
  记录信息可以长期保存而不丢失 
  非破坏性读出
  **缺点**：
  存取速度较慢 
  机械结构复杂 
  对工作环境要求较高
+ ![550](Attachments/Pasted%20image%2020240620161310.png)![](Attachments/Pasted%20image%2020240620161920.png)
+ 磁带速度比磁盘速度慢，原因是磁带上的数据采用**顺序访问**方式，而磁盘则采用**直接访问**方式。

+ **光盘**![](Attachments/Pasted%20image%2020240620162219.png)
+ **CRT 显示器**![](Attachments/Pasted%20image%2020240620162613.png)

# 第八章、输入输出系统
+ **CPU 与外设之间的数据传送方式**![](Attachments/Pasted%20image%2020240620163639.png)
+ **程序查询（Polling）方式**![](Attachments/Pasted%20image%2020240620163838.png)
+ **程序中断方式**
  + **中断处理过程**![](Attachments/Pasted%20image%2020240620164251.png)
  + **多级中断**
    一个系统有 n 级中断，则 CPU 中有 n 个 IR，n 个 IM，某级中断被响应后，则**关闭本级和低于本级的 IM （即：对应的 IM 置 1）**，开放更高级的 IM
    多级中断可以嵌套，但同一级的中断不允许嵌套
    
+ **直接存储器存取（DMA：Direct Memory Access ） 方式**
  直接存储器访问 (DMA) 是一种**完全由硬件实现** I/O 交换的工作方式
  + **DMA 传送方式**：成组传送方式（停止 CPU 访问内存）、周期窃取方式、DMA 与 CPU 交替访内存方式 ![550](Attachments/Pasted%20image%2020240620170034.png)
  + **DMA 数据传送处理过程**![500](Attachments/Pasted%20image%2020240620170333.png)
    
+ **通道方式**：无条件传送方式。**通道是一种具有特定功能的处理器**，它具有自己的指令和程序，专门负责数据输入输出的控制和管理











