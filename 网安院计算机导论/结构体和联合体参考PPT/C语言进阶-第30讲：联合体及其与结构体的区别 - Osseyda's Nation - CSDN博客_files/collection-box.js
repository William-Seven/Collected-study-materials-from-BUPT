!function(l){window.jQuery?l(window.csdn=window.csdn||{},void 0):window.jQuery||function(){var e=document.createElement("script"),t=document.getElementById("collection-script")||document.head.lastElementChild||document.head.lastChild;e.src="//csdnimg.cn/public/common/libs/jquery/jquery-1.9.1.min.js",e.type="text/javascript";var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://g.csdnimg.cn/user-login/2.1.5/user-login.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n),myDOM=t.previousElementSibling||t.previousSibling,e.onload=function(){l(window.csdn=window.csdn||{},void 0)},document.body.insertBefore(e,t)}()}(function(m,r){var C=window.jQuery||{},e=r,t=r,L=window.document,o="1.1.2",n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://g.csdnimg.cn/user-login/2.1.5/user-login.js";var l=document.getElementsByTagName("script")[0];l.parentNode.insertBefore(n,l);var f={baseUrl:"//g.csdnimg.cn/collection-box/",userTag:"UserName",ads:"//g.csdnimg.cn/collection-box/1.1.2/collection-box.css",collectionTag:"[data-bind-collection=true]",prefixStyleTag:"g-",styleTag:"collection-box",status:{create:"add-collection",list:"list-collection"},requestHostName:"//me.csdn.net",messageInfoTimer:1800};m.collectionBox=m.collectionBox?m.collectionBox:{},C===window.jQuery?(t=function(e,t){var o=[];return C(t,e).each(function(e,t){o.push(t)}),o},e=!0):t=function(e){return L.querySelectorAll(e)},C.COLLECTION={version:o,v:"1.1.2"},C.COLLECTION.labels={currentTab:"add-collection"},m.collectionBox.params&&a(m.collectionBox.params),m.collectionBox.scope=C.COLLECTION;function c(l){var c=document.cookie;return c&&function(){for(var e,t={},o=0,n=(c=c.split("; ")).length;o<n&&!(0<(e=c[o].split("=")).length&&(e[0]===l&&(t.key=e[0],t.value=e[1],t.status=!0),"key"in t));o++);return"key"in t&&t}()}function O(e){return e.replace(/^\s*/g,"").replace(/\s*$/g,"")}function g(e,t,o){window.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)}function i(e,t,o){window.removeEventListener?e.removeEventListener(t,o,!1):e.detachEvent("on"+t,o)}function a(e){function t(e){if(e?"url"in e&&""!==e.url?"source"in e&&""!==e.source?"source_id"in e&&""!==e.source_id?"author"in e&&""!==e.author?"title"in e&&""!==e.title||(console.warn("调用请提供标题信息"),o=!1):(console.warn("调用请提供访问用户作者信息"),o=!1):(console.warn("调用请提供访问来源source_id！"),o=!1):(console.warn("调用请提供访问来源类型！"),o=!1):(console.warn("调用请提供访问来源地址！"),o=!1):(console.warn("调用请提供访问需设参数！"),o=!1),!1===o)return!1}var o=!0;if(C.COLLECTION.params||t(e),C.COLLECTION.params){if(e&&o){for(var n in e)C.COLLECTION.params[n]=e[n];t(C.COLLECTION.params)}}else o&&(C.COLLECTION.params=e);return o}function p(e){for(var t,o,n=0,l="";t=e[n];)l+='<li><span class="title"><a href="###">'+(o=t).Name+'</a></span><em class="info"><i>'+o.FavoriteNum+'</i>条内容</em><a href="" class="btn-collect btn-collect-pos '+(0<o.CheckStatus?"btn-uncollected":"btn-collected")+'" data-id="'+o.ID+'" name="collection-btn"'+(0<o.CheckStatus?"data-checkId="+o.CheckStatus:"")+">"+(0<o.CheckStatus?"已收藏":"收藏")+"</a></li>",n++;return l}function v(e){var t=C(C.COLLECTION.gMessage);t.text(e),t.addClass("g-fadeInDown"),setTimeout(function(){t.removeClass("g-fadeInDown")},f.messageInfoTimer)}function s(){var t={};function s(e){var t,o,n,l,c,r,i=0,a=!1,s=e.pos,u=e.msg;if(!s)return!1;if(d=u&&(c=(o=e).msg,(r=o.pos)&&!r.isCreate?((l=L.createElement("div")).className="g-collection-error",l.innerHTML=c,r.isCreate=!0,l):((n=r.querySelector(".g-collection-error"))&&(n.innerHTML=c),n))){for(s.appendChild(d),s.eleTag=d;t=C.COLLECTION.formError[0];){if(t===s){a=!0;break}i++}a||C.COLLECTION.formError.push(s)}else{var d;if((d=s.querySelector(".g-collection-error")||C(".g-collection-error",s).get(0))&&!u)for(s.removeChild(d),delete s.eleTag,delete s.isCreate;t=C.COLLECTION.formError[i];){if(t===s){C.COLLECTION.formError.splice(i,1);break}i++}}}C.COLLECTION.formError=[];var o,n,l,u,e,c,r,d={title:{reg:"([^\\s*]+){2,20}",min:2,max:20,msg:"长度在 2 到 20 个字符"}},i=C.COLLECTION.formGroup,a=C.COLLECTION.formBtns;if(!a||!i)return console.warn("collection option is fail!"),!1;o=i.querySelector(".form-title")||C("#g-form-title",i).get(0),n=i.querySelector(".form-des")||C("#g-form-des",i).get(0),l=i.querySelector(".form-check")||C("#g-form-checks",i).get(0),u=a.querySelector(".btn-confirm")||C("#g-btn-confirm",a).get(0),e=a.querySelector(".btn-reset")||C("#g-btn-reset",a).get(0),c=function(e){var t,o,n,l,c=O(e&&e.value||this.value),r=O(e&&e.value||this.value),i=e&&e.getAttribute("data-name")||this.getAttribute("data-name"),a=!0;t=(i=i&&d[i]).reg&&new RegExp(i.reg,"g"),l=i.reg&&i.msg||"格式不正确",o=i.min,n=i.max,t&&(r=(r=r.match(t))&&r[0]),r?(o||n)&&(c.length<o||c.length>n)&&(a=!1):a=!1,!1===a?u.isNoSub=!0:delete u.isNoSub,s(!1===a?{msg:l,pos:this.parentNode}:{pos:this.parentNode})},r=function(){var e=l.getElementsByTagName("input");if(t.name=O(o.value),t.description=O(n.value),t.source=C.COLLECTION.params.source,t.is_private=0<e.length&&(e[0].checked?0:1),!C.ajax)return console.warn("请导入jquery, 发起请求"),!1;C.ajax({type:"post",url:f.requestHostName+"/api/favorite/createFolder",data:JSON.stringify(t),crossDomain:!0,xhrFields:{withCredentials:!0},success:function(e){if(200===e.code){var t=e.data,o=p([t]);v("创建成功!"),y(o,"single"),m.collectionBox.getState(null,"list"),I()}},error:function(t){var o;if(t){try{o=JSON.parse(t.responseText).message}catch(e){o=t.statusText}v(o||"创建失败!")}}})},o.onblur=function(){c.call(this)},u&&g(u,"click",function(){if(o.focus(),o.blur(),u.isNoSub)return!1;r()}),e&&g(e,"click",function(){m.collectionBox.close()})}function u(e){var t,o,n,l,c,r=f.prefixStyleTag?f.prefixStyleTag:"g-";return o='<div class="g-collection-box g-collection-skin '+f.styleTag+("add-collection"===C.COLLECTION.labels.currentTab?" g-collection":"")+'"><span class="'+r+'close-btn" id="g-close-btn">&times</span><div class="collection-title '+r+'collection-title">添加收藏</div><div class="collection-title '+r+'create-title">新建收藏夹</div><div class="collection-content"><ul class="list '+(e?"":"hide")+'" id="g-collection-list">'+(e||"")+'</ul><div class="collection-blank '+(e?"hide":"")+'"><span class="g-monkey"><img src="'+f.baseUrl+C.COLLECTION.version+'/images/monkey-pixel.svg" alt="no result"></span><em>没有收藏列表内容！</em></div><div class="'+r+'collection-form" id="g-collection-form"><div class="'+r+'form-control"><label class="label-title" for="g-form-title">标题</label><input data-name="title" tabindex="1" class="'+r+'form-control-text form-title" id="g-form-title" placeholder="请填写收藏夹的名称" type="text"/></div><div class="'+r+'form-control"><label class="label-title" for="g-form-des">描述（选填）</label><textarea data-name="des" class="'+r+'form-control-text form-des" id="g-form-des" placeholder="请填写收藏夹的名称" rows="8"></textarea></div><div class="'+r+"form-control "+r+'form-control-private"><label class="label-title">私密</label><span class="check-group form-check" id="g-form-checks"><span><input type="radio" name="radios" id="public-radio" value="0" checked/> <label for="public-radio">公开 所有人可见</label></span><span><input type="radio" name="radios" id="private-radio" value="1"/> <label for="private-radio">私密 只有你可以查看这个收藏夹</label></span></span></div></div></div><div class="'+r+'btn-group" id="g-btn-group"><a href="javascript:void(0);" class="btn-add-collection '+r+'btn" onclick="window.csdn.collectionBox.getState(this, \'create\');">+ 新建收藏夹</a><a href="javascript:void(0);" id="g-btn-back" class="btn-back '+r+'btn" onclick="window.csdn.collectionBox.getState(this, \'list\');">返回</a><a href="javascript:void(0);" id="g-btn-reset" class="btn-reset '+r+'btn">取消</a><a href="javascript:void(0);" id="g-btn-confirm" class="btn-confirm '+r+'btn">确定</a></div></div>',n=L.body,l=L.createDocumentFragment(),(c=L.createElement("div")).className="g-collection-mark",c.innerHTML=o+'<span class="g-collection-message" id="g-collection-message"></span>',C.COLLECTION.fragmentDom=l,C.COLLECTION.htmlDom=c,C.COLLECTION.collectionDom=c.firstElementChild||c.firstChild,C.COLLECTION.closeBtn=C.COLLECTION.collectionDom.querySelector("."+r+"close-btn")||C.COLLECTION.collectionDom.children[0],C.COLLECTION.collectionList=C.COLLECTION.collectionDom.querySelector(".list")||C("#g-collection-list",C.COLLECTION.collectionDom).get(0),C.COLLECTION.formGroup=C.COLLECTION.collectionDom.querySelector("."+r+"collection-form")||C("#g-collection-form",C.COLLECTION.collectionDom).get(0),C.COLLECTION.formBtns=C.COLLECTION.collectionDom.querySelector("."+r+"btn-group")||C("#g-btn-group",C.COLLECTION.collectionDom).get(0),C.COLLECTION.gMessage=c.lastElementChild||c.lastChild,C.COLLECTION.collectionDom.isCreate=!0,l.appendChild(c),t=n.appendChild(l),s(),t}function d(n,l){var e=C.COLLECTION.params.url;C.ajax({type:"get",url:f.requestHostName+"/api/favorite/folderListWithCheck?url="+e,crossDomain:!0,xhrFields:{withCredentials:!0},success:function(e){var t,o;200===e.code&&e.data&&(t=e.data.result,o=p(t),!C.COLLECTION.collectionDom||C.COLLECTION.collectionDom&&!C.COLLECTION.collectionDom.isCreate?n(o):y(o),l())},error:function(t){var o;if(t){try{o=JSON.parse(t.responseText).message}catch(e){o=t.statusText}v(o||"获取收藏列表失败!")}}})}function E(e,t){var o;return o="all"===e?"none":"block","start"===e&&(o="block"),C.COLLECTION.collectionDom&&(C.COLLECTION.collectionDom.parentNode.style.display=o,C.COLLECTION.collectionDom.status="block"===o||!(C.COLLECTION.runStatus=!0)),C.COLLECTION.collectionDom.status&&t&&t(),C.COLLECTION}function N(){function e(e){var t=e||window.event;if(C.COLLECTION.collectionDom.status&&t.target===this)return E("all"),b(),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation(),!1}C.COLLECTION.collectionDom.parentNode&&!C.COLLECTION.collectionDom.parentNode.isClick&&(i(C.COLLECTION.collectionDom.parentNode,"click",e),g(C.COLLECTION.collectionDom.parentNode,"click",e),C.COLLECTION.collectionDom.parentNode.isClick=!0),C.COLLECTION.closeBtn&&!C.COLLECTION.closeBtn.isCloseClick&&(i(C.COLLECTION.closeBtn,"click",e),g(C.COLLECTION.closeBtn,"click",e),C.COLLECTION.closeBtn.isCloseClick=!0)}function T(e){var t,o,n,l,c=(!C.COLLECTION.collectionDom||C.COLLECTION.collectionDom&&!C.COLLECTION.collectionDom.isCreate)&&!C.COLLECTION.linkCss&&(o=L.head,n=o.firstElementChild||o.firstChild,(l=L.createElement("link")).rel="stylesheet",l.type="text/css",l.href=f.ads,t=o.insertBefore(l,n),!!(C.COLLECTION.linkCss=t));if(!1===a(e))return console.warn("调用失败！"),!1;c?d(u,function(){E(r),N(),I()}):C.COLLECTION.collectionDom&&d(y,function(){E(r),I()})}function h(){var n=C(f.collectionTag,L)||t(L,f.collectionTag);return e?C(L).on("click",f.collectionTag,function(e){var t=e||window.event;return window.csdn.userLogin.loadAjax(function(e){T()}),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation(),t.returnValue?t.returnValue=!1:t.preventDefault(),!1}):0<n.length&&function(){C.COLLECTION.collectionBtns=n;function e(e){var t=e||window.event;window.csdn.userLogin.loadAjax(function(e){T()}),t.cancelBubble?t.cancelBubble=!0:t.stopPropagation(),t.returnValue?t.returnValue=!1:t.preventDefault()}for(var t,o=0;n[o];)t=n[o],g(t,"click",e),o++}(),!0}var b=m.collectionBox.getState=function(e,l){return window.csdn.userLogin.loadAjax(function(e){var t,o,n;"list"===(l=l||"list")&&function(){var e,t=C.COLLECTION.formGroup,o=t.querySelector(".form-title")||L.getElementById("g-form-title"),n=t.querySelector(".form-des")||L.getElementById("g-form-des"),l=t.querySelector(".form-check")||L.getElementById("g-form-checks");if(o.value&&(o.value=""),n.value&&(n.value=""),l){var c=l.getElementsByTagName("input");c&&(c[0].checked=!0)}if(0<C.COLLECTION.formError.length)for(;e=C.COLLECTION.formError.shift();)e.eleTag&&delete e.isCreate&&e.removeChild(e.eleTag)}(),C.COLLECTION.labels.currentTab=f.status[l],"add-collection"===(t=t||C.COLLECTION.labels.currentTab)?(o=new RegExp("(s*g-collection([^-]|$))","g"),n=" g-create"):"list-collection"===t&&(o=new RegExp("(s*g-create([^-]|$))","g"),n=" g-collection"),C.COLLECTION.collectionDom.className=C.COLLECTION.collectionDom.className.replace(o,n)}),m.collectionBox},I=function(){var c;C(".btn-collect","#g-collection-list").off("click"),C(".btn-collect","#g-collection-list").on("click",function(e){var t={},n=C(this),o=Number(C(this).attr("data-id"),10),l=Number(C(this).attr("data-checkId"),10);if(C(this).hasClass("btn-collected")){if(c=f.requestHostName+"/api/favorite/create",!(C.COLLECTION.params.url&&C.COLLECTION.params.title&&C.COLLECTION.params.author&&C.COLLECTION.params.source&&C.COLLECTION.params.source_id))return alert("缺少提交参数!"),!1;t.url=C.COLLECTION.params.url,t.title=C.COLLECTION.params.title,t.description=C.COLLECTION.params.description||"",t.author=C.COLLECTION.params.author,t.source=C.COLLECTION.params.source,t.source_id=Number(C.COLLECTION.params.source_id,10),t.folder_id=o,n.isCollect=!0}else if(C(this).hasClass("btn-uncollected")){if(c=f.requestHostName+"/api/favorite/delete",!C.COLLECTION.params.source)return alert("缺少提交参数!"),!1;t.source=C.COLLECTION.params.source,l&&(t.ids=[l]),n.isCollect=!1}return C.ajax({type:"post",url:c,data:JSON.stringify(t),crossDomain:!0,xhrFields:{withCredentials:!0},success:function(e){var t=n.closest("li").find(".info i"),o=Number(t.html(),10)||0;200===e.code&&(n.isCollect?(n.attr("data-checkId",e.data.ID).removeClass("btn-collected").addClass("btn-uncollected").text("已收藏"),o+=1):(n.removeAttr("data-checkId").removeClass("btn-uncollected").addClass("btn-collected").text("收藏"),o-=1),t.html(o))},error:function(t){var o;if(t){try{o=JSON.parse(t.responseText).message}catch(e){o=t.statusText}v(o||"操作失败!")}}}),!1})},y=function(e,t){var o,n,l=C.COLLECTION.collectionList;l&&("single"===t?(l.className=l.className.replace(/hide/g,""),(n=L.createElement("ul")).innerHTML=e,n=n.firstElementChild||n.firstChild,o=l.firstElementChild||l.firstChild||null,e&&l.insertBefore(n,o)):e&&(l.innerHTML="",l.innerHTML=e))};m.collectionBox.close=function(){return!C.COLLECTION.collectionDom||C.COLLECTION.collectionDom&&!C.COLLECTION.collectionDom.status||C.COLLECTION.collectionDom.status&&(b(),E("all")),m.collectionBox},m.collectionBox.show=function(t){return window.csdn.userLogin.loadAjax(function(e){T(t)}),m.collectionBox};function x(){if(result=c(f.userTag),!result||result&&!result.status)return!1;h()}function w(){x()}function k(e){function t(){n||(n=!0,o&&o())}var o,n,l;document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(function(){e&&e()},0):(D=function(){document.removeEventListener("DOMContentLoaded",D,!1),e()},document.addEventListener("DOMContentLoaded",D,!1)):document.attachEvent&&(o=e,n=!1,(l=function(){try{L.documentElement.doScroll("left")}catch(e){return void setTimeout(l,50)}t()})(),L.onreadystatechange=function(){"complete"===L.readyState&&(L.onreadystatechange=null,t())})}var D;_ready=function(){e&&C(function(){w()})||k(w)},_ready()});